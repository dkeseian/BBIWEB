000100180129CREATE OR REPLACE PROCEDURE BBIWEB.ST_UTRAN1  (IN STORE INT)
000200160613 RESULT SETS 1
000300160613 LANGUAGE SQL
000400160613 BEGIN
000500180129  DECLARE C1 CURSOR WITH RETURN FOR
000600180129  SELECT TO_CHAR(A.CREATEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCRTDTE ,
000700180129  TO_CHAR(A.CHANGEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCHGDTE,
000800180129  TO_CHAR(APPRVEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARAPPDTE,
000900180129  TO_CHAR(POSTEDDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARPSTDTE,
001000180129  TO_CHAR(RECEIVDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARRCVDTE,
001100180129  IFNULL(C.TRNCOMMENT, '') AS TRNCOMMENT,
001200180129  A.*
001300180129
001400180129 FROM BBIWEB.BBV170AH A
001500180129    LEFT JOIN BBIWEB.BBP170B C  ON C.TRANSFERID = A.TRANSFERID
001600180129                 AND LINESEQ = 0
001700180202 WHERE (POSTEDFLG = ' ' AND APPRVEDTE IS NULL)
001800180202 OR    (POSTEDFLG = 'A' AND APPRVEDTE IS NULL)
001900180202 AND FROMSTORE <> TOSTORE
002000180208 ORDER BY             CREATEDTE     ;
002100160615
002200180129 DECLARE C2 CURSOR WITH RETURN FOR
002300161017  SELECT TO_CHAR(B.CREATEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCRTDTE ,
002400161017  TO_CHAR(B.CHANGEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCHGDTE,
002500160615  TO_CHAR(APPRVEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARAPPDTE,
002600160615  TO_CHAR(POSTEDDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARPSTDTE,
002700160815  TO_CHAR(RECEIVDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARRCVDTE,
002800160829  IFNULL(C.TRNCOMMENT, '') AS TRNCOMMENT,
002900160613  B.*
003000160613
003100160630 FROM BBIWEB.BBV170AH B
003200160829    LEFT JOIN BBIWEB.BBP170B C  ON C.TRANSFERID = B.TRANSFERID
003300160829                 AND LINESEQ = 0
003400180202 WHERE (POSTEDFLG = ' ' AND APPRVEDTE IS NULL
003500180202 OR     POSTEDFLG = 'A' AND APPRVEDTE IS NULL)
003600180129 AND FROMSTORE <> TOSTORE
003700180202 AND TOSTORE   =  STORE
003800180208 ORDER BY             CREATEDTE     ;
003900180129 CASE STORE
004000180129 WHEN -999
004100180129 THEN
004200180129    OPEN C1;
004300180129 ELSE
004400180129   OPEN C2;
004500180129 END CASE ;
004600160613 END
