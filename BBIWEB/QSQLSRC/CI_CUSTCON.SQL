000100161214-- Retrieve the customer CREDIT information.
000200161108-- Pass in the customer number or a string of customer name
000300170103CREATE or replace PROCEDURE bbiweb.ci_custcon
000400170103   (IN CUSTOMER CHAR(14),COMPANY CHAR(5), LICENSE CHAR(10))
000500161213
000600170105result sets 4
000700161213LANGUAGE SQL
000800161213BEGIN
000900161222
001000161213DECLARE C1 CURSOR FOR
001100161219SELECT *
001200161216FROM ARDBFA.ARPAD
001300170103WHERE  ADCO   =  RIGHT('     ' || COMPANY,5)
001400170103AND    ADCUNO =  RIGHT('              ' || CUSTOMER,14)
001500170103AND    ADSADD =  RIGHT('          ' || LICENSE,10);
001600161221
001700180206-- DECLARE C2 CURSOR FOR
001800180206--    SELECT CUUFL2,CUUFL3,CUUFL4
001900180206--      FROM ARDBFA.ARPCU
002000180206--      WHERE  CUCO   =  RIGHT('     ' || COMPANY,5)
002100180206--      AND    CUCUNO =  RIGHT('              ' || CUSTOMER,14);
002200161221
002300180206DECLARE C2 CURSOR FOR
002400180206   SELECT CAST(
002500180207      CASE LEFT(CUUFL2,1)
002600180206      WHEN 'Y'
002700180206      THEN CUTXID
002800180206      ELSE ' ' END AS CHAR(18)) AS CUUFL2,
002900180207      CAST(LEFT(CUUFL2,1) AS CHAR(10)) AS CUUFL3,
003000180611      CUUFL4 , CUTEL
003100180206     FROM ARDBFA.ARPCU
003200180206    WHERE  CUCO   =  RIGHT('     ' || COMPANY,5)
003300180206      AND    CUCUNO =  RIGHT('              ' || CUSTOMER,14) ;
003400180206
003500171025DECLARE C3 CURSOR FOR
003600180611SELECT CUCO,CUCUNO,CUNAME,CUAICD,CUPTPC,CCCRCN,CCCRLM,CCCBAL,CCCRCP
003700170105FROM ARDBFA.ARPCU
003800170105INNER JOIN ARDBFA.ARPCC
003900170105ON CUCO = CCCO AND CUCUNO = CCCUNO
004000170105WHERE  CUCO   =  RIGHT('     ' || COMPANY,5)
004100170105AND    CUCUNO =  RIGHT('              ' || CUSTOMER,14);
004200170105
004300160511OPEN c1;
004400161221OPEN c2;
004500161221OPEN c3;
004600160511End
004700160511
