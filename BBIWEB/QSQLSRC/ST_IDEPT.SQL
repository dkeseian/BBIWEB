000100170807CREATE or replace PROCEDURE bbiweb.st_IDept  (IN store int,dept int)
000200160511result sets 1
000300160511LANGUAGE SQL
000400160511BEGIN
000500170602/* Store number has been passed */
000600160511DECLARE c1 CURSOR with return FOR
000700170726select
000800170728   a.R09ADT,
000900170728   a.R07DSC
001000170728  from glcust.glvrdpstr a
001100170728 where a.s99co = 1
001200170807   and a.s99loc = STORE
001300170809    AND A.R09ADT = DEPT;
001400170809
001500170809/* Store number has NOT been passed */
001600170809DECLARE c2 CURSOR with return FOR
001700170809select
001800170809   a.R09ADT,
001900170809   a.R07DSC
002000170809  from glcust.glvrdp a
002100170809 where a.s99co = 1
002200170809 AND A.R09ADT = DEPT;
002300170809
002400170809 CASE STORE
002500170809 WHEN 0
002600170809 THEN
002700170809    OPEN c2;
002800170809 ELSE
002900170809   OPEN C1;
003000170809 END CASE ;
003100160511End
003200160511
