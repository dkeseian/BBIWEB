000100180117CREATE OR REPLACE PROCEDURE BBIWEB.ST_ACTIVUP
000200180117   (IN AUSERPROF CHAR(20),ATRANSFERID INT)
000300180117
000400160824LANGUAGE SQL
000500160824
000600180117IF EXISTS(SELECT * FROM BBIWEB.BBP170C WHERE USERPROF = AUSERPROF)
000700160824
000800160824THEN
000900160824
001000180117UPDATE BBIWEB.BBP170C
001100160824  SET
001200180117       ACTIVITY1  = ATRANSFERID,
001300180117       ACTIVITY2  = ACTIVITY1,
001400180117       ACTIVITY3  = ACTIVITY2,
001500180117       ACTIVITY4  = ACTIVITY3,
001600180117       ACTIVITY5  = ACTIVITY4
001700160824
001800180130WHERE USERPROF     = AUSERPROF
001900180130  AND ATRANSFERID <> ACTIVITY1
002000180130  AND ATRANSFERID <> ACTIVITY2
002100180130  AND ATRANSFERID <> ACTIVITY3
002200180130  AND ATRANSFERID <> ACTIVITY4
002300180130  AND ATRANSFERID <> ACTIVITY5;
002400160824
002500160824ELSE
002600180117   INSERT INTO BBIWEB.BBP170C
002700180117         (USERPROF,
002800180117          ACTIVITY1)
002900180117   VALUES(AUSERPROF,
003000180117          ATRANSFERID);
003100160824   END IF
