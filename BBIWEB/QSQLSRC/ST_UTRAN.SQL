000100161107CREATE OR REPLACE PROCEDURE BBIWEB.ST_UTRAN   (IN STORE INT)
000200160613 RESULT SETS 1
000300160613 LANGUAGE SQL
000400160613 BEGIN
000500160613  DECLARE C1 CURSOR WITH RETURN FOR
000600160829  SELECT TO_CHAR(A.CREATEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCRTDTE ,
000700160829  TO_CHAR(A.CHANGEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCHGDTE,
000800160615  TO_CHAR(APPRVEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARAPPDTE,
000900160615  TO_CHAR(POSTEDDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARPSTDTE,
001000160815  TO_CHAR(RECEIVDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARRCVDTE,
001100160829  IFNULL(C.TRNCOMMENT, '') AS TRNCOMMENT,
001200160613  A.*
001300160613
001400160630 FROM BBIWEB.BBV170AH A
001500160829    LEFT JOIN BBIWEB.BBP170B C  ON C.TRANSFERID = A.TRANSFERID
001600160829                 AND LINESEQ = 0
001700170418 WHERE POSTEDFLG = ' ' OR POSTEDFLG = 'A'
001800170530 ORDER BY   TOSTORE , APPRVEFLG;
001900160615
002000160613 DECLARE C2 CURSOR WITH RETURN FOR
002100161017  SELECT TO_CHAR(B.CREATEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCRTDTE ,
002200161017  TO_CHAR(B.CHANGEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARCHGDTE,
002300160615  TO_CHAR(APPRVEDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARAPPDTE,
002400160615  TO_CHAR(POSTEDDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARPSTDTE,
002500160815  TO_CHAR(RECEIVDTE, 'YYYY-MM-DD HH24:MI:SS') AS CHARRCVDTE,
002600160829  IFNULL(C.TRNCOMMENT, '') AS TRNCOMMENT,
002700160613  B.*
002800160613
002900160630 FROM BBIWEB.BBV170AH B
003000160829    LEFT JOIN BBIWEB.BBP170B C  ON C.TRANSFERID = B.TRANSFERID
003100160829                 AND LINESEQ = 0
003200170418 WHERE TOSTORE = STORE AND (POSTEDFLG = ' ' OR POSTEDFLG = 'A')
003300170530 ORDER BY   TOSTORE , APPRVEFLG;
003400160613 CASE STORE
003500160613 WHEN -999
003600160613 THEN
003700160613    OPEN C1;
003800160613 ELSE
003900160613   OPEN C2;
004000160613 END CASE ;
004100160613 END
